(function(){var e,t,r,n,i,s,o,a,l,_,u,c,f,p,d,h,g,m,v,x,y,E,b,N,O,w,S,R,T,k,D,A,C,L,I,P,U,q=[].indexOf||function(e){for(var t=0,r=this.length;r>t;t++)if(t in this&&this[t]===e)return t;return-1},F=function(e,t){function r(){this.constructor=e}for(var n in t)M.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},M={}.hasOwnProperty,j=[].slice;null==Array.prototype.unique&&(Array.prototype.unique=function(){var e,t,r,n;for(n=[],t=0,r=this.length;r>t;t++)e=this[t],q.call(n,e)<0&&n.push(e);return n}),null==$.fn.attrAll&&($.fn.attrAll=function(e,t,r){var n;return null==t&&(t=" "),null==r&&(r=!0),n=[],this.each(function(t,r){return n.push($(r).attr(e)),!0}),r&&(n=n.unique()),n.join(t)}),E=function(e){var t,r;return t=function(e,n){var i,s,o,a,l;for(null==n&&(n=[]),l=[],s=o=0,a=e.length;a>=0?a>o:o>a;s=a>=0?++o:--o)i=e.splice(s,1),0===e.length&&r.push(n.concat(i)),t(e.slice(),n.concat(i)),l.push(e.splice(s,0,i[0]));return l},r=[],t(e),r},b=function(e,t){var r,n,i,s,o,a,l;for(l=[],s=e.length,o=function(){var e,n,i;for(i=[],r=e=0,n=t;n>=0?n>e:e>n;r=n>=0?++e:--e)i.push(r);return i}();;){if(l.push(function(){var t,r,i;for(i=[],t=0,r=o.length;r>t;t++)n=o[t],i.push(e[n]);return i}()),o[0]===s-t)break;for(r=t-1;r>=0&&o[r]+t-r===s;)r--;for(a=o[r],o[r]++,i=2,r++;t>r;)o[r]=a+i,r++,i++}return l},N=function(e,t){var r,n,i,s,o;for(n={},s=0,o=e.length;o>s;s++)r=e[s],null==(i="function"==typeof t?t(r):void 0)&&(i=r),null==n[i]&&(n[i]=[]),n[i].push(r);return n},P=function(e){var t,r,n,i,s,o,a,l;for(e=D(e),t=[],function(){var r,n;n=[];for(r in e)0===e[r].cnt?(delete e[r],n.push(t.push(r))):n.push(void 0);return n}(),l=[],function(){var t,r,n;n=[];for(r in e)n.push(function(){var n;n=[];for(t in e[r].v)null==l[t]&&(l[t]=[]),n.push(l[t].push(r));return n}());return n}(),a=[];t.length>0;)for(r=t.pop(),a.push(r),o=l[r]||[],n=0,i=o.length;i>n;n++)s=o[n],I(e[s],r),0===e[s].cnt&&(t.push(s),delete e[s]);for(r in e)throw new Error("FormValidator::validate: Detected cyclical dependencies. Adjust your dependency definitions");return a},D=function(e){var t,r,n,i,s,o,a,l,_;l={},i=C();for(s in e)for(_=e[s],l[s]=C(),r=_.split(" "),o=0,a=r.length;a>o;o++)t=r[o],""!==t&&(t!==s&&L(l[s],t),L(i,t));for(n in i.v)n in l||(l[n]=C());return l},C=function(){return{cnt:0,v:{}}},L=function(e,t){return e.v[t]||(e.cnt+=1,e.v[t]=!0),e},I=function(e,t){return e.v[t]&&(e.cnt-=1,delete e.v[t]),e},g={},y=function(e,t,r,n){var i,s,o,a,l,_,u,c,f,p,d,h,m;if(null==r&&(r=""),null==n&&(n=""),e=e.slice(0),e.sort(),i=e.join("_"),null!=g[i])return g[i];for(s=a=p=e.length;a>0;s=a+=-1)for(d=b(e,s),u=0,l=d.length;l>u;u++)for(m=d[u],h=E(m),c=0,_=h.length;_>c;c++)if(f=h[c],o=r+f.join("_")+n,null!=S[t][o])return g[i]=o,o;return null},i={NORMAL:"NORMAL",SIMPLE:"SIMPLE"},i.DEFAULT=i.NORMAL,s={BELOW:"BELOW",TOOLTIP:"TOOLTIP",POPOVER:"POPOVER",NONE:"NONE"},s.DEFAULT=s.NONE,d={DEPENDENCIES:"DEPENDENCIES",VALUE:"VALUE",CONSTRAINTS:"CONSTRAINTS"},h={DEPENDENCIES:"DEPENDENCY",VALUE:"VALUE",CONSTRAINTS:"CONSTRAINT"},e={ENUMERATE:"ENUMERATE",SENTENCE:"SENTENCE",LIST:"LIST"},e.DEFAULT=e.ENUMERATE,n={PHASE_ORDER:[d.DEPENDENCIES,d.VALUE,d.CONSTRAINTS],BUILD_MODE:e.DEFAULT},p=["depends_on","id","name","preprocess","required","type"],c=["dependency_mode","error_classes","success_classes","dependency_error_classes","error_targets","group","output_preprocessed","postprocess","constraints","errors","valid_constraints","valid_dependencies","valid_value","value"],r={PREPROCESS:!0,POSTPROCESS:!1,REQUIRED:!0,OUTPUT_PREPROCESSED:!0,DEPENDENCY_MODE:"all",ERROR_TARGETS:"",INCLUDE_MAX:"true",INCLUDE_MIN:"true"},o={ERROR_MODES:i,ERROR_OUTPUT_MODES:s,VALIDATION_PHASES:d,BUILD_MODES:e,ERROR_MESSAGE_CONFIG:n},t={max:["include_max"],max_length:["enforce_max_length"],min:["include_min"],min_length:["enforce_min_length"],regex:["regex_flags"]},U={_number:function(e,t){var r;if(e=e.replace(/\s/g,""),"+"===e[0]&&(e=e.slice(1)),"."===e[0]?e="0"+e:"-"===e[0]&&"."===e[1]&&(e="-0."+e.slice(2)),e.indexOf(".")>=0){for(;"0"===e[e.length-1];)e=e.slice(0,-1);"."===e[e.length-1]&&(e=e.slice(0,-1))}return r=parseFloat(e),isNaN(r)||!isFinite(r)||e!==""+r?{error_message_type:"number",_number:r,_string:e}:{valid:!0,_number:r,_string:e}},_text:function(e,t){return e.length>0},email:function(e,t){var r;return e.indexOf("@")<0?{error_message_type:"email_at"}:(r=e.split("@"),r.length>2?{error_message_type:"email_many_at"}:2===r.length&&""!==r[0]&&""!==r[1]?e.indexOf(".",e.indexOf("@"))<0||"."===e[e.length-1]?{error_message_type:"email_dot"}:!0:{error_message_type:"email"})},integer:function(e,t){var r,n;return n=this._number(e,t),n.valid===!0?n._number===Math.floor(n._number)?!0:{error_message_type:"integer_float"}:(e=n._string,r=Math.floor(n._number),isNaN(r)||!isFinite(r)||e!==""+r?{error_message_type:"integer"}:(n.error_message_type=n.error_message_type.replace("number_","integer_"),n))},number:function(e,t){var r;return r=this._number(e,t),r.valid===!0?!0:r},phone:function(e,t){for(e=e.replace(/[\s+\+\-\/\(\)]/g,"");"0"===e[0];)e=e.slice(1);return e!==""+parseInt(e,10)?{error_message_type:"phone"}:!0},text:function(e,t){return e.length>0},radio:function(e,t){return $("[name='"+t.attr("name")+"']:checked").length>0},checkbox:function(e,t){return t.prop("checked")===!0},select:function(e,t){return this.text(t.val())}},x={blacklist:function(e,t){var r,n,i;for(n=0,i=e.length;i>n;n++)if(r=e[n],t.indexOf(r)>=0)return!1;return!0},max:function(e,t,r){return"false"===(null!=r?r.include_max:void 0)?t>e:t>=e},max_length:function(e,t){return e.length<=t},min:function(e,t,r){return"false"===(null!=r?r.include_min:void 0)?e>t:e>=t},min_length:function(e,t){return e.length>=t},regex:function(e,t,r){return new RegExp(t,r.flags).test(e)},whitelist:function(e,t){var r,n,i;for(n=0,i=t.length;i>n;n++)if(r=t[n],e.indexOf(r)<0)return!1;return!0}},m=[],v={include_max:!0,include_min:!0,enforce_max_length:!0,enforce_min_length:!0},O=function(e,t,r){return null!=t?v[e]instanceof Function?""+v[e](r)==""+t:""+v[e]==""+t:!1},S={de:{and:"und",gt:"größer als",gte:"größer als oder gleich",lt:"kleiner als",lte:"kleiner als oder gleich"},en:{and:"and",gt:"greater than",gte:"greater than or equal to",lt:"less than",lte:"less than or equal to"}},$.extend(S.de,{dependency_general:"Die Abhängigkeiten dieses Felds müssen zuerst korrekt ausgefüllt wurden",dependency_prefix:"Die Felder",dependency_suffix:"müssen noch korrekt ausgefüllt werden",dependency_singular_prefix:"Das Feld",dependency_singular_suffix:"muss noch korrekt ausgefüllt werden",value_email:"'{{value}}' muss die Form 'meine.adresse@anbieter.endung' haben",value_email_at:"'{{value}}' muss ein @-Zeichen enthalten",value_email_many_at:"'{{value}}' darf höchstens ein @-Zeichen enthalten",value_email_dot:"'{{value}}' muss eine korrekte Endung haben (z.B. '.de')",value_integer:"'{{value}}' muss eine Zahl sein",value_integer_float:"'{{value}}' darf keine Kommazahl sein",value_number:"'{{value}}' muss eine Zahl sein",value_phone:"'{{value}}' darf nur aus Zahlen, Leerzeichen und den Zeichen '+-/()' bestehen",value_radio:"Eins der Optionsfelder muss ausgewählt werden",value_checkbox:"Das Kontrollkästchen muss ausgewählt werden",value_select:"Es muss eine andere Option ausgewählt werden",value_text:"Das Textfeld muss ausgefüllt werden",constraint_enumerate_prefix:"'{{value}}'",constraint_list_prefix:"'{{value}}'",constraint_sentence_prefix:"'{{value}}'",constraint_blacklist_prefix:"darf",constraint_blacklist:"keines der Zeichen '{{blacklist}}'",constraint_blacklist_suffix:"enthalten",constraint_whitelist_prefix:"muss",constraint_whitelist:"jedes der Zeichen '{{whitelist}}'",constraint_whitelist_suffix:"enthalten",constraint_max_prefix:"darf",constraint_max:"nicht größer als oder gleich {{max}}",constraint_max_suffix:"sein",constraint_max_include_max_prefix:"darf",constraint_max_include_max:"nicht größer als {{max}}",constraint_max_include_max_suffix:"sein",constraint_max_length_prefix:"darf",constraint_max_length:"nicht länger als {{max_length}} Zeichen",constraint_max_length_suffix:"sein",constraint_max_length_enforce_max_length_prefix:"wurde",constraint_max_length_enforce_max_length:"auf {{max_length}} Zeichen",constraint_max_length_enforce_max_length_suffix:"gekürzt",constraint_min_prefix:"darf",constraint_min:"nicht kleiner als oder gleich {{min}}",constraint_min_suffix:"sein",constraint_min_include_min_prefix:"darf",constraint_min_include_min:"nicht kleiner als {{min}}",constraint_min_include_min_suffix:"sein",constraint_min_length_prefix:"darf",constraint_min_length:"nicht kürzer als {{min_length}} Zeichen",constraint_min_length_suffix:"sein",constraint_min_length_enforce_min_length_prefix:"wurde",constraint_min_length_enforce_min_length:"auf {{min_length}} Zeichen",constraint_min_length_enforce_min_length_suffix:"verlängert",constraint_regex_prefix:"muss",constraint_regex:"dem regulären Ausdruck '{{regex}}'",constraint_regex_suffix:"entsprechen"}),$.extend(S.en,{dependency_general:"This field's dependencies must be correctly filled in first",dependency_prefix:"The fields",dependency_suffix:"must be filled in correctly",dependency_singular_prefix:"The field",dependency_singular_suffix:"must be filled in correctly",value_email:"'{{value}}' address must be of the form 'my.address@provider.ending'",value_email_at:"'{{value}}' address must contain an @ symbol",value_email_many_at:"'{{value}}' address can only have one @ symbol",value_email_dot:"'{{value}}' must have a correct ending (i.e. '.com')",value_integer:"'{{value}}' must be an integer",value_integer_float:"'{{value}}' must not be decimal",value_number:"'{{value}}' must be a number",value_phone:"'{{value}}' can only contain numbers, spaces, and the characters '+-/()'",value_radio:"One of the radio buttons must be selected",value_checkbox:"The checkbox must be selected",value_select:"Another option must be selected",value_text:"Please fill in this text field",constraint_enumerate_prefix:"'{{value}}'",constraint_list_prefix:"'{{value}}'",constraint_sentence_prefix:"'{{value}}'",constraint_blacklist_prefix:"must not",constraint_blacklist:"contain any of the characters '{{blacklist}}'",constraint_blacklist_suffix:"",constraint_whitelist_prefix:"must",constraint_whitelist:"contain all of the characters '{{whitelist}}'",constraint_whitelist_suffix:"",constraint_max_prefix:"must not",constraint_max:"be greater than or equal to {{max}}",constraint_max_suffix:"",constraint_max_include_max_prefix:"must not",constraint_max_include_max:"be greater than {{max}}",constraint_max_include_max_suffix:"",constraint_max_length_prefix:"must not",constraint_max_length:"be longer than {{max_length}} characters",constraint_max_length_suffix:"",constraint_max_length_enforce_max_length_prefix:"was",constraint_max_length_enforce_max_length:"shortened to {{max_length}} characters",constraint_max_length_enforce_max_length_suffix:"",constraint_min_prefix:"must not",constraint_min:"be less than or equal to {{min}}",constraint_min_suffix:"",constraint_min_include_min_prefix:"must not",constraint_min_include_min:"be less than {{min}}",constraint_min_include_min_suffix:"",constraint_min_length_prefix:"must not",constraint_min_length:"be shorter than {{min_length}} characters",constraint_min_length_suffix:"",constraint_min_length_enforce_min_length_prefix:"was",constraint_min_length_enforce_min_length:"extended to {{min_length}} characters",constraint_min_length_enforce_min_length_suffix:"",constraint_regex_prefix:"must",constraint_regex:"match the regular expression '{{regex}}'",constraint_regex_suffix:""}),w={de:{},en:{}},w.de[e.ENUMERATE]=null,w.de[e.SENTENCE]=null,w.de[e.LIST]=null,w.en[e.ENUMERATE]=null,w.en[e.SENTENCE]=null,w.en[e.LIST]=null,T={},k={},l=function(){function e(e,t,r){3===arguments.length?(this.func=r,e[t]=this):this.func=arguments[0]}return e.prototype.make=function(){return this.func.apply(this,arguments)},e}(),u=function(e){function t(e,r){t.__super__.constructor.call(this,k,e,r)}return F(t,e),t.prototype.create_data=function(e,t,r,n){return this.make(e,t,r,n)},t}(l),_=function(e){function t(e,r){t.__super__.constructor.call(this,T,e,r)}return F(t,e),t.prototype.build_message=function(e,t,r,n,i){return this.make(e,t,r,n,i)},t}(l),f=function(){function e(){this._dict={},this._order=[]}return e.prototype.put=function(e,t,r){var n;return this._dict[e]=t,null==r?q.call(this._order,e)<0&&this._order.push(e):(n=this._order.indexOf(e),n>=0&&this._order.splice(n,1),this._order.splice(r,0,e)),this},e.prototype.get=function(e){return this._dict[e]},e.prototype.remove=function(e){var t;return delete this._dict[e],this._order=function(){var r,n,i,s;for(i=this._order,s=[],r=0,n=i.length;n>r;r++)t=i[r],t!==e&&s.push(t);return s}.call(this),this},e.prototype.join=function(e){var t;return null==e&&(e=""),function(){var r,n,i,s,o;for(s=this._order,o=[],n=0,i=s.length;i>n;n++)t=s[n],o.push(("function"==typeof(r=this._dict[t]).join?r.join(e):void 0)||this._dict[t]);return o}.call(this).join(e)},e.prototype.each=function(e){var t,r,n,i,s;for(s=this._order,t=n=0,i=s.length;i>n;t=++n)if(r=s[t],e.call(this,r,this._dict[r],t)===!1)return this;return this},e.prototype.to_array=function(){var e;return function(){var t,r,n,i;for(n=this._order,i=[],t=0,r=n.length;r>t;t++)e=n[t],i.push(this._dict[e]);return i}.call(this)},e.prototype.to_object=function(){var e,t,r,n;r={},t=this._dict;for(e in t)n=t[e],r[e]=n;return r},e.prototype.get_object=function(){return this._dict},e.prototype.get_order=function(){return this._order},e}(),A=function(){var e,t,r,n,i,s;if(t=arguments[0],s=2<=arguments.length?j.call(arguments,1):[],s=1===s.length?s[0]:$.extend.apply($,s),"string"==typeof t){for(e in s)i=s[e],n="{{"+e+"}}",t.indexOf(n)>=0&&(r=new RegExp(n,"g"),t=t.replace(r,i));return t}if(t instanceof Function)return t(s);throw new Error("FormValidator: Error while building an error message. Expected mustache-like string or function but was given:",t,s)},new u(d.DEPENDENCIES,function(e,t,r,n){var i,s,o,a,l,_,u,c;return l=function(){var t,r,n;for(n=[],t=0,r=e.length;r>t;t++)i=e[t],null!=i.name&&n.push(i.name);return n}(),l.length===e.length?(o=S[n],s=h[t].toLowerCase(),1===l.length&&(s+="_singular"),u=s+"_prefix",c=s+"_suffix",_=function(){var e,t,r;for(r=[],e=0,t=l.length;t>e;e++)a=l[e],r.push({message:"'"+a+"'",prefix:o[u],suffix:o[c]});return r}()):(s=h[t].toLowerCase()+"_general",_=[]),{parts:_}}),new u(d.VALUE,function(e,t,r,n){var i,s,o;return i=e[0],s=h[t].toLowerCase()+"_"+(i.error_message_type||i.type),o={message:A(S[n][s],i),prefix:"",suffix:""},{key:s,parts:[o]}}),new u(d.CONSTRAINTS,function(e,t,r,n){var i,s,o,a,l,_,u,c,f,p,d,g,v,x,E,b,N,w,R,T,k,D,C,L,I,P,U,F,M;for(k=[],u=[],F=[],g=0,v=e.length;v>g;g++){for(o=e[g],l=!1,c=w=0,x=m.length;x>w;c=++w)_=m[c],I=o.type,q.call(_,I)>=0&&(l=!0,null!=u[c]?u[c].push(o):u[c]=[o]);l||F.push(o)}for(R=0,E=F.length;E>R;R++)o=F[R],u.push([o]);for(D=h[t].toLowerCase(),p=D+"_",i=S[n][(D+"_"+r+"_prefix").toLowerCase()]||"",s=S[n][(D+"_"+r+"_suffix").toLowerCase()]||"",L=0,b=u.length;b>L;L++)if(e=u[L],null!=e){for(d=[],U=0,N=e.length;N>U;U++)if(o=e[U],d.push(o.type),null!=o.options){P=o.options;for(T in P)M=P[T],O(T,M,n)&&d.push(T)}f=y(d,n,p),null!=f&&k.push({message:A.apply(null,[S[n][f]].concat(j.call(e))),prefix:A(S[n][f+"_prefix"],o)||i,suffix:A(S[n][f+"_suffix"],o)||s})}return f=D+"_"+r.toLowerCase(),C=A(""+S[n][f+"_prefix"],e[0]),a=$.extend.apply($,[{}].concat(e)),{key:f,parts:k,error_data:a,prefix:C}}),R=new l(function(e,t,r,n,i,s,o,a){var l,_,u,c,p,d,h,g,m,v,x,y;for(null==o&&(o=" "),null==a&&(a=" "),c=e.key,x=e.parts,_=null!=(y=e.error_data)?y:{},i=i||e.prefix||S[n][c+"_prefix"]||"",s=s||e.suffix||S[n][c+"_suffix"]||"",e.prefix=("function"==typeof i?i():void 0)||i,e.suffix=("function"==typeof s?s():void 0)||s,u=p=0,d=x.length;d>p;u=++p)v=x[u],l=new f,v.prefix&&(l.put("prefix",v.prefix),l.put("prefix_delimiter",v.prefix_delimiter||o)),l.put("message",v.message),v.suffix&&(l.put("suffix_delimiter",v.suffix_delimiter||a),l.put("suffix",v.suffix)),x[u]=l;for(m=new f,u=g=0,h=x.length;h>g;u=++g)v=x[u],m.put(u,v);return e.parts=m,e}),new _(e.ENUMERATE,function(e,t,r,n){var i,s,o,a,l,_,u,c,p,d,h,g,m,v,x,y,E,b;e=R.make(e,t,r,n),g=e.parts.to_array(),o=S[n],v=N(g,function(e){return e.get("suffix")||""}),g=[];for(E in v){b=v[E],m=N(b,function(e){return e.get("prefix")||""});for(x in m)for(y=m[x],i=s=0,a=y.length;a>s;i=++s)d=y[i],i>0&&(d.remove("prefix"),d.remove("prefix_delimiter"));for(i=u=0,l=b.length;l>u;i=++u)d=b[i],i<b.length-1&&(d.remove("suffix_delimiter"),d.remove("suffix"));g=g.concat(b)}for(c=new f,i=p=0,_=g.length;_>p;i=++p)h=g[i],i===g.length-1&&(h.put("prefix"," "+S[n].and+" "+(h.get("prefix")||""),0),h.put("prefix_delimiter"," ",1)),c.put(i,h);return e.parts=c,((e.prefix||"")+" "+c.join("")+" "+(e.suffix||"")).replace(/\s+/g," ")}),new _(e.SENTENCE,function(e,t,r,n){var i,s,o,a,l;for(e=R.make(e,t,r,n),e.parts.each(function(t,r){return r.put("prefix",(" "+(e.prefix||"")+" "+(r.get("prefix")||"")).trim(),0),r.put("prefix_delimiter"," ",1),r.put("suffix_delimiter",r.get("suffix")?r.get("suffix_delimiter"):"",3),r.put("suffix",(" "+(e.suffix||"")+" "+(r.get("suffix")||"")+".").trim(),4),!0}),a=[],l=e.parts.to_array(),i=0,s=l.length;s>i;i++)o=l[i],a.push(o.join());return a.join(" ").replace(/\s+/g," ").trim()}),new _(e.LIST,function(t,r,n,i){var s,o;return o=T[e.SENTENCE].build_message(t,r,n,i),"."===o[o.length-1]&&(o+=" "),"<ul><li>"+function(){var e,t,r,n;for(r=o.split(". "),n=[],e=0,t=r.length;t>e;e++)s=r[e],s&&n.push(s+".");return n}().join("</li><li>")+"</li></ul>"}),a=function(){function e(e,t){this.form_validator=e,null!=s[t.error_output_mode]||t.error_output_mode instanceof Function?this.error_output_mode=t.error_output_mode:this.error_output_mode=s.DEFAULT}return e.prototype._apply_classes=function(e,t,r,n){var i,s,o,a,l;if(null!=t){for(l=this.form_validator._find_targets(t,e),i=s=0,o=l.length;o>s;i=++s)a=l[i],a instanceof jQuery||(a=l.eq(i)),n===!1?a.addClass(r):a.removeClass(r);return l}return[]},e.prototype._set_message_below=function(e,t,r){var n;return null==(n=t.data("_fv_error_container"))&&("radio"===r.type&&(t=$("input[name='"+t.attr("name")+"']").last()),0===(n=t.next(".fv-error-message")).length&&(n=$('<div class="fv-error-message" />'),t.after(n)),t.data("_fv_error_container",n)),n.html(e),this},e.prototype._set_message_tooltip=function(e,t,r){return null==t.data("_fv_tooltip")&&t.tooltip({html:!0,placement:t.attr("data-placement")||"top",title:function(){return $(this).data("_fv_tooltip")}}),t.data("_fv_tooltip",e).tooltip("hide"),this},e.prototype._set_message_popover=function(e,t,r){return"checkbox"===r.type||"radio"===r.type||"select"===r.type?(t.attr("title",e),this):(null==t.data("_fv_popover")&&t.popover({html:!0,placement:t.attr("data-placement")||"right",content:function(){return $(this).data("_fv_popover")},trigger:"manual"}).focus(function(){return t.popover("show"),!1}).blur(function(){return t.popover("hide"),!0}).click(function(){return document.activeElement===this&&t.popover("toggle"),!0}),t.data("_fv_popover",e).popover("hide"),this)},e.prototype._process_error_message=function(e,t,r){var n,i;return this.error_output_mode===s.NONE?this:(this.error_output_mode instanceof Function?(i=this.error_output_mode(t,r,e),i.html(e)):(n=this.error_output_mode.toLowerCase(),this["_set_message_"+n](e,t,r)),this)},e.prototype._process_max_length=function(e,t,r){var n,i;return"true"===e.options.enforce_max_length?(n=parseInt(e.value,10),i=r.value.slice(0,n),r.value=i,t.val(i),!0):!1},e.prototype._process_min_length=function(e,t,r){var n,i,s;return"true"===e.options.enforce_min_length?(i=parseInt(e.value,10),s=r.value+function(){var e,t,s;for(s=[],n=e=0,t=r.value.length-i;t>=0?t>e:e>t;n=t>=0?++e:--e)s.push(".");return s}().join(""),r.value=s,t.val(s),!0):!1},e.prototype._process_constraint=function(e,t,r){var n;return("function"==typeof this[n="_process_"+e.name]?this[n](e,t,r):void 0)||!1},e.prototype.modify=function(e,t){var r,n,i,s,o,a,l,_,u,c,f,p,h,g,m,v,x,y,E,b,N,O,w,S;for(u=this.form_validator,_=u.fields.all,l=u.error_output_mode,f=h=0,N=_.length;N>=0?N>h:h>N;f=N>=0?++h:--h){for(s=_.eq(f),n=u._get_element_data(s),c=null,x=0,g=e.length;g>x;x++)if(o=e[x],o.element.is(s)){c=o;break}if(null==c)p=!0,S=!0,y="";else{for(p=!1,S=!0,O=c.errors,E=0,m=O.length;m>E;E++)if(a=O[E],a.phase===d.DEPENDENCIES)S=!1;else if(a.phase===d.CONSTRAINTS)for(w=n.constraints,b=0,v=w.length;v>b;b++)if(r=w[b],r.name===a.type){i=this._process_constraint(r,s,n),i&&u._set_element_data(s,n);break}y=c.message}t.apply_error_classes===!0&&(this._apply_classes(s,n.error_targets,n.error_classes||u.error_classes,p),this._apply_classes(s,n.error_targets,n.success_classes||u.success_classes,!p),this._apply_classes(s,n.depends_on,n.dependency_error_classes||u.dependency_error_classes,S)),this._process_error_message(y,s,n)}return this},e}(),window.FormValidator=function(){function n(t,r){var n;null==r&&(r={}),n=this.constructor,this.form=t,this.fields=null,this.form_modifier=new a(this,r),this.error_classes=r.error_classes||this.form.attr("data-fv-error-classes")||"fv-invalid",this.success_classes=r.success_classes||this.form.attr("data-fv-success-classes")||"fv-valid",this.dependency_error_classes=r.dependency_error_classes||this.form.attr("data-fv-dependency-error-classes")||"fv-invalid-dependency",this.validators=$.extend({},n.validators,r.validators),this.validation_options=r.validation_options||null,this.constraint_validators=$.extend({},n.constraint_validators,r.constraint_validators),this.build_mode=r.build_mode||e.DEFAULT,this.error_mode=null!=n.ERROR_MODES[r.error_mode]?r.error_mode:n.ERROR_MODES.DEFAULT,this.locale=r.locale||"en",this.error_target_getter=r.error_target_getter||null,this.field_getter=r.field_getter||null,this.required_field_getter=r.required_field_getter||null,this.create_dependency_error_message=r.create_dependency_error_message||null,this.preprocessors=$.extend(n.default_preprocessors,r.preprocessors||{}),this.postprocessors=r.postprocessors||{},this.group=r.group||null,this.process_errors=r.process_errors||null}var i,s;for(s in o)i=o[s],n[s]=i;return n.constraint_validators=x,n.validators=U,n.locales=S,n.default_preprocessors={number:function(e,t,r){switch(r){case"de":return e.replace(/\,/g,".");default:return e}},integer:function(e,t,r){switch(r){case"de":return e.replace(/\,/g,".");default:return e}}},n.configure=function(e){return e({constraint_validator_groups:m,constraint_validator_options_in_locale_key:v,constraint_validator_options:constraint_validator_options,locale_message_builders:w,message_builders:T,message_data_creators:k}),this},n.get_error_message_type=function(e,t){var r;return t===this.ERROR_MODES.SIMPLE?r=e.split("_")[0]:e},n._build_error_message=function(e,t,r,n){var i;return i=k[e].create_data(t,e,r,n),T[r].build_message(i,e,r,n)},n.get_error_message_for_element=function(e,t,r,n,i){var s,o,a,l,_,u,c;null==i&&(i=" "),o=[],a={};for(u in d)a[u]=function(){var e,r,n;for(n=[],e=0,r=t.length;r>e;e++)s=t[e],s.phase===u&&n.push(s);return n}();for(c=this.ERROR_MESSAGE_CONFIG.PHASE_ORDER,l=0,_=c.length;_>l;l++)u=c[l],a[u].length>0&&o.push(this._build_error_message(u,a[u],r,n));return o.join(i)},$(document).on("click","[data-fv-start]",function(){var e,t,r,i,s,o,a;if(e=$(this),null==(t=e.data("_form_validator_container"))&&(t=e.closest(e.attr("data-fv-start")),0===t.length&&(t=$(e.attr("data-fv-start"))),e.data("_form_validator_container",t)),null==(o=t.data("_form_validator"))){if(a=e.attr("data-fv-start-options"),null!=a)try{a=JSON.parse(a)}catch(i){r=i;try{a=window[a]()}catch(s){r=s,a={}}}o=n["new"](t,a),t.data("_form_validator",o)}return o.validate(),!1}),$(document).on("change keyup","[data-fv-real-time] [data-fv-validate]",function(e){var t,r,i,s,o,a;return t=$(this),a=(null!=(o=t.attr("type"))?o.toLowerCase():void 0)||"",s=1===t.filter("textarea").length||t.filter("input").length&&("button"===a||"checkbox"===a||"color"===a||"file"===a||"image"===a||"radio"===a||"range"===a||"submit"===a),"change"===e.type&&s?!0:(r=t.closest("[data-fv-real-time]"),1===r.length&&(null==(i=r.data("_form_validator"))&&(i=n["new"](r),r.data("_form_validator",i)),i.validate({focus_invalid:!1})),!1)}),n["new"]=function(e,t){return new this(e,t)},n.prototype._get_attribute_value_for_key=function(e,t){var n,i,s,o,a,l,_,u;return a="data-fv-",_={type:"validate",required:"optional"},i=["preprocess","required"],n=null==_[t]?a+t.replace(/\_/g,"-"):a+_[t],u=e.attr(n),s=null!=u,s?u=u.trim():(l=o=t.toUpperCase(),q.call(Object.keys(r),l)>=0&&(u=r[o])),q.call(i,t)>=0&&(u="true"===u||u===!0),"required"===t&&s&&(u=!u),u},n.prototype._set_element_data=function(e,t){return $.data(e[0],"_fv",t),this},n.prototype._get_element_data=function(e){return $.data(e[0],"_fv")},n.prototype._cache_attribute=function(e,t,r,n){return null==n?n=e.attr("data-fv-"+r.replace(/\_/g,"-")):n instanceof Function&&(n=n.call(this)),t[r]=n,t},n.prototype._get_fields=function(e){return("function"==typeof this.field_getter?this.field_getter(e):void 0)||e.find("[data-fv-validate]").filter(function(e,t){return 0===$(t).closest("[data-fv-ignore-children]").length})},n.prototype._get_required=function(e){return("function"==typeof this.required_field_getter?this.required_field_getter(e):void 0)||e.not("[data-fv-optional='true']")},n.prototype._get_value_info=function(e,t){var r,n,i,s,o,a;return i=t.type,n=t.preprocess,s=!0,o=e.val(),null==o&&(s=!1,o=e.text()),r=o,a=r!==t.value,t.value=r,null!=this.preprocessors[i]&&n!==!1&&(o=this.preprocessors[i].call(this.preprocessors,o,e,this.locale)),{usedValFunc:s,value:o,original_value:r,value_has_changed:a}},n.prototype._find_targets=function(e,t,r){var n;return null==r&&(r=/\s+/g),"string"==typeof e?function(){var i,s,o,a;for(o=e.split(r),a=[],i=0,s=o.length;s>i;i++)n=o[i],a.push(this._find_target(n,t));return a}.call(this):e||[]},n.prototype._find_target=function(e,t){var r;return"self"===e?t:(r=this.form.find("[data-fv-name='"+e+"']"),0===r.length&&(r=t.closest(e)),0===r.length&&(r=this.form.find(e)),0===r.length&&(r=$(e)),r)},n.prototype._get_error_targets=function(e,t){return("function"==typeof this.error_target_getter?this.error_target_getter(e,t):void 0)||e.attr("data-fv-error-targets")||e.closest("[data-fv-error-targets]").attr("data-fv-error-targets")||r.ERROR_TARGETS},n.prototype._group=function(e){var t,r,n,i,o,a,l,_;for(r={},a=l=0,_=e.length;_>=0?_>l:l>_;a=_>=0?++l:--l)n=e.eq(a),t=this._get_element_data(n),null==t.group&&(t.group=n.attr("data-fv-group")||t.name,this._set_element_data(n,t)),o=t.group,null==r[o]?r[o]=[n]:r[o].push(n);return function(){var e;e=[];for(s in r)i=r[s],e.push(i);return e}()},n.prototype._group_errors=function(e,t){var r,n,i,s,o,a,l,_,u,c;for(r=this.constructor,c=[],o=this.fields.all,a=l=0,u=o.length;u>=0?u>l:l>u;a=u>=0?++l:--l)n=o.eq(a),i=function(){var t,r,i;for(i=[],r=0,t=e.length;t>r;r++)s=e[r],s.element.is(n)&&i.push(s);return i}(),i.length>0&&(_=t.messages===!0?r.get_error_message_for_element(n,i,this.build_mode,this.locale):"",c.push({element:n,errors:i,message:_}));return c},n.prototype._validate_value=function(e,t,r){var n,i,s,o;if(n=t.type,o=r.value,s=this.validators[n],null==s)throw new Error("FormValidator::_validate_value: No validator found for type '"+n+"'. Make sure the type is correct or define a validator!");return i=s.call(this.validators,o,e),i===!1?i={error_message_type:n}:"string"==typeof i&&(i={error_message_type:i}),i!==!0&&(i.error_message_type=this.constructor.get_error_message_type(i.error_message_type,this.error_mode)),i},n.prototype._validate_dependencies=function(e,t,n){var i,s,o,a,l,_,u,c,f;for(l=[],a=t.depends_on,_=u=0,c=a.length;c>u;_=++u)s=a[_],i=this._get_element_data(s),o=this._validate_element(s,i,this._get_value_info(s,i),n),o.length>0&&l.push({dependency_element:s,element:e,index:_,type:i.type,name:i.name});return null==t.dependency_mode&&(t.dependency_mode=e.attr("data-fv-dependency-mode")||r.DEPENDENCY_MODE,this._set_element_data(e,t)),f="any"===t.dependency_mode?l.length<a.length:0===l.length,{dependency_errors:l,dependency_elements:a,valid_dependencies:f,dependency_mode:t.dependency_mode}},n.prototype._validate_constraints=function(e,n,i){var s,o,a,l,_,u,c,f,p,d,h,g,m,v,x,y;if(y={},null!=n.constraints)c=n.constraints;else{s=this.constructor,c=[],v=this.constraint_validators;for(a in v)if(l=v[a],null!=(u=e.attr("data-fv-"+a.replace(/\_/g,"-")))){if(null!=(_=t[a]))for(m={},f=0,p=_.length;p>f;f++)g=_[f],m[g]=e.attr("data-fv-"+g.replace(/\_/g,"-"))||r[g.toUpperCase()];else m=null;c.push({name:a,options:m,validator:l,value:u})}n.constraints=c,this._set_element_data(e,n)}for(h=0,d=c.length;d>h;h++)o=c[h],o.validator.call(this.constraint_validators,i,o.value,o.options)===!0?y[o.name]=!0:(x={},x.options=o.options,x[o.name]=o.value,y[o.name]=x);return y},n.prototype._validate_element=function(e,t,r,n){var i,s,o,a,l,_,u,c,f,p,h,g,m,v,x,y,E,b,N,O,w,S,R,T,k,D,A;if(u=[],x=!0,c=t.required,S=t.type,D=r.value,m=r.original_value,A=r.value_has_changed,R=r.usedValFunc,v=d.DEPENDENCIES,y=this._validate_dependencies(e,t,n),a=y.dependency_errors,s=y.dependency_elements,l=y.dependency_mode,T=y.valid_dependencies,T)t.valid_dependencies=!0,t.errors[v]=[];else{for(x=!1,t.valid_dependencies=!1,f=0,p=a.length;p>f;f++)o=a[f],$.extend(o,{element:e,required:c,type:"dependency",phase:v,mode:l});t.errors[v]=a}if(u=u.concat(t.errors[v]),v=d.VALUE,A?!x&&n.stop_on_error||(k=this._validate_value(e,t,r),k!==!0?(x=!1,t.valid_value=!1,t.errors[v]=[{element:e,error_message_type:k.error_message_type,phase:v,required:c,type:S,value:D}]):(t.valid_value=!0,t.errors[v]=[])):!x&&n.stop_on_error||t.valid_value!==!0&&(x=!1),u=u.concat(t.errors[v]),v=d.CONSTRAINTS,A){if(x||!n.stop_on_error){t.valid_constraints=!0,w=[],E=this._validate_constraints(e,t,D);for(i in E)O=E[i],O!==!0&&(t.valid_constraints=!1,x=!1,w.push($.extend(O,{element:e,required:c,type:i,phase:v,value:D})));t.errors[v]=w}}else!x&&n.stop_on_error||t.valid_constraints!==!0&&(x=!1);if(u=u.concat(t.errors[v]),t.valid_dependencies&&t.valid_value&&t.valid_constraints){if(t.valid===!0&&null!=t.postprocess&&null!=t.output_preprocessed||(t.valid=!0,this._cache_attribute(e,t,"postprocess"),this._cache_attribute(e,t,"output_preprocessed")),t.postprocess===!0||t.output_preprocessed===!0)for(t.postprocess===!0?D=null!=(b=this.postprocessors[S])?b.call(this.postprocessors,D,e,this.locale):void 0:t.output_preprocessed===!0&&(D=null!=(N=this.preprocessors[S])?N.call(this.preprocessors,D,e,this.locale):void 0),R?e.val(D):e.text(D),g=0,h=u.length;h>g;g++)_=u[g],_.value=D}else t.valid!==!1&&(t.valid=!1);return n.apply_error_classes===!0&&null==t.error_targets&&this._cache_attribute(e,t,"error_targets",function(){return this._get_error_targets(e,S)}),this._set_element_data(e,t),u},n.prototype.register_validator=function(e,t,r){return this.validators[e]=t,this},n.prototype.deregister_validator=function(e){return delete this.validators[e],this},n.prototype.register_preprocessor=function(e,t){return this.preprocessors[e]=t,this},n.prototype.deregister_preprocessor=function(e){return delete this.preprocessors,this},n.prototype.register_postprocessor=function(e,t){return this.postprocessors[e]=t,this},n.prototype.deregister_postprocessor=function(e){return delete this.postprocessors[e],this},n.prototype.cache=function(){var e,t,r,n,i,s,o,a,l,_,u;for(r=this._get_fields(this.form),this.fields={all:r,required:this._get_required(r)},n=s=0,u=r.length;u>=0?u>s:s>u;n=u>=0?++s:--s){for(t=r.eq(n),e={},l=0,o=p.length;o>l;l++)i=p[l],e[i]=this._get_attribute_value_for_key(t,i);for(e.depends_on=this._find_targets(e.depends_on,t,/^\s*\;\s*$/g),e.id=n,_=0,a=c.length;a>_;_++)i=c[_],e[i]=null;e.errors={},e.errors[d.DEPENDENCIES]=[],e.errors[d.VALUE]=[],e.errors[d.CONSTRAINTS]=[],this._set_element_data(t,e)}return this},n.prototype.validate=function(e){var t,r,n,i,o,a,l,_,u,c,f,p,d,h,g,m,v,x,y,E,b,N,O,w,S,R,T,k,D,A,C;for(null==e&&(e={}),n={all:!1,
apply_error_classes:!0,focus_invalid:!0,messages:!0,stop_on_error:!0,recache:!1},e=$.extend(n,this.validation_options,e),null!=this.fields&&e.recache!==!0||this.cache(),t=this.constructor,c=[],k=!1,R=this.fields.required,f=this.fields.all,p=null,a={},m={},h=x=0,w=f.length;w>=0?w>x:x>w;h=w>=0?++x:--x){for(_=f.eq(h),r=this._get_element_data(_),m[r.id]=_,l=[],S=r.depends_on,b=0,y=S.length;y>b;b++)i=S[b],o=this._get_element_data(i),l.push(o.id);a[r.id]=l.join(" ")}for(f=function(){var e,t,r,n;for(r=P(a),n=[],t=0,e=r.length;e>t;t++)g=r[t],n.push(m[g]);return n}(),N=0,E=f.length;E>N;N++)_=f[N],r=this._get_element_data(_),v=r.required,T=r.type,s=r.name,C=this._get_value_info(_,r),D=C.value,O=C.original_value,A=C.value_has_changed,k=C.usedValFunc,e.all!==!1||v||0!==D.length&&"radio"!==T&&"checkbox"!==T?(u=this._validate_element(_,r,C,e),u.length>0&&(null==p&&(p=_),c=c.concat(u))):null==r.error_targets&&(r=this._cache_attribute(_,r,"error_targets",function(){return this._get_error_targets(_,T)}),this._set_element_data(_,r));return e.focus_invalid===!0&&null!=p&&p.focus(),d=this._group_errors(c,e),"function"==typeof this.process_errors&&this.process_errors(d),this.form_modifier.modify(d,e),d},n.prototype.get_progress=function(e){var t,r,n,i,s,o,a,l,_,u,c,f,p,d,h,g,m,v,x,y;for(null==e&&(e={as_percentage:!1,recache:!1}),null!=this.fields&&e.recache!==!0||this.cache(),o=this.fields.all,x=this.fields.required,_=("function"==typeof this.group?this.group(o):void 0)||this._group(o),y=_.length,r=0,s=this.validate({apply_error_classes:!1,all:!0}),u=c=0,f=_.length;f>c;u=++c){for(l=_[u],t=!0,g=0,p=l.length;p>g;g++)if(n=l[g],n=$(n),x.index(n)>=0){t=!1;break}for(a=!1,m=0,d=l.length;d>m;m++){for(n=l[m],n=$(n),v=0,h=s.length;h>v;v++)if(i=s[v],i.element.is(n)){a=!0;break}if(a)break}a||r++}return e.as_percentage?r/y:{count:r,total:y}},n}()}).call(this);